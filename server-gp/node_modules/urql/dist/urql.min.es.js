import{createClient as n,createRequest as r}from"@urql/core";export*from"@urql/core";import{createContext as t,useContext as e,useRef as o,useState as u,useCallback as i,useEffect as c,useMemo as a}from"react";import{toPromise as f,makeSubject as s,concat as v,fromValue as l,subscribe as p,takeWhile as d,share as x,scan as h,switchMap as y,map as g}from"wonka";var b=t(n({url:"/graphql"})),m=b.Provider,q=b.Consumer,P=function(){return e(b)};function k(){return(k=Object.assign||function(n){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}return n}).apply(this,arguments)}var w={fetching:!1,stale:!1,error:void 0,data:void 0,extensions:void 0,operation:void 0};function j(n){var t=o(!0),e=P(),a=u(w),s=a[0],v=a[1];function l(n){return t.current&&v({fetching:!1,stale:!!n.stale,data:n.data,error:n.error,extensions:n.extensions,operation:n.operation}),n}var p=i((function(t,o){return v(k({},w,{fetching:!0})),f(e.executeMutation(r(n,t),o||{})).then(l)}),[e,n,v]);function d(){t.current=!1}return c((function(){return d}),[]),[s,p]}var I=!1;function M(n,r){var t=a((function(){var r=s();return[v([l(n),r.source]),function(t){t!==n&&r.next(n=t)}]}),[]),e=t[0],o=t[1],i=u((function(){var t;return I=!0,p((function(n){t=n}))(r(l(n))).unsubscribe(),I=!1,t})),f=i[0],d=i[1];function x(n){I||d((function(r){return function(n,r){if("object"!=typeof n||"object"!=typeof r)return n!==r;for(var t in n)if(!(t in r))return!0;for(var e in r)if(n[e]!==r[e])return!0;return!1}(r,n)?n:r}))}return c((function(){return p(x)(r(e,f)).unsubscribe}),[e]),[f,o]}function O(n,t){var e=o(void 0);return a((function(){var o=r(n,t);return void 0!==e.current&&e.current.key===o.key?e.current:(e.current=o,o)}),[n,t])}var Q=function(n,r){return n.suspense&&(!r||!1!==r.suspense)},S=new Map;function C(n,r){return k({},n,r)}function z(n){return{fetching:!1,stale:!!n.stale,data:n.data,error:n.error,operation:n.operation,extensions:n.extensions}}function A(n){return n?v([l({fetching:!0,stale:!1}),g(z)(n),l({fetching:!1,stale:!1})]):l({fetching:!1,stale:!1})}function B(n,r){return h(C,r||w)(y(A)(n))}function D(n){var r=P(),t=O(n.query,n.variables),e=i((function(e){var o=Q(r,n.context),u=o?S.get(t.key):void 0;return u||(u=r.executeQuery(t,k({},{requestPolicy:n.requestPolicy,pollInterval:n.pollInterval},n.context,e)),o&&S.set(t.key,u=function(n){var r,t,e=x(n);function o(n){t=n}return function(n){var u=!1;if(d((function(n){return void 0===r&&Promise.resolve(n).then(t),r=n,!u}))(e)(n),void 0===r)throw u=!0,n(0),new Promise(o);var i=[r];i.tag=1,n(i)}}(u))),u}),[r,t,n.requestPolicy,n.pollInterval,n.context]),o=a((function(){return n.pause?null:e()}),[n.pause,e]),u=M(o,i(B,[])),f=u[0],s=u[1],v=i((function(n){return s(e(n))}),[s,e]);return c((function(){S.delete(t.key),Q(r,n.context)||s(o)}),[s,r,o,t,n.context]),Q(r,n.context)&&s(o),[f,v]}function E(n){return{fetching:!0,stale:!!n.stale,data:n.data,error:n.error,extensions:n.extensions,operation:n.operation}}function F(n){return n?v([l({fetching:!0,stale:!1}),g(E)(n),l({fetching:!1,stale:!1})]):l({fetching:!1})}function G(n,r){var t=P(),e=o(r);e.current=r;var u=O(n.query,n.variables),f=i((function(r){return t.executeSubscription(u,k({},n.context,r))}),[t,u,n.context]),s=a((function(){return n.pause?null:f()}),[n.pause,f]);function v(n,r){var t=e.current;return k({},n,r,{data:void 0!==r.data?"function"==typeof t?t(n.data,r.data):r.data:n.data})}var l=M(s,i((function(n,r){return h(v,r||w)(y(F)(n))}),[])),p=l[0],d=l[1],x=i((function(n){return d(f(n))}),[d,f]);return c((function(){d(s)}),[d,s]),[p,x]}function H(n){var r=j(n.query);return n.children(k({},r[0],{executeMutation:r[1]}))}function J(n){var r=D(n);return n.children(k({},r[0],{executeQuery:r[1]}))}function K(n){var r=G(n,n.handler);return n.children(k({},r[0],{executeSubscription:r[1]}))}export{q as Consumer,b as Context,H as Mutation,m as Provider,J as Query,K as Subscription,P as useClient,j as useMutation,D as useQuery,G as useSubscription};
//# sourceMappingURL=urql.min.es.js.map
